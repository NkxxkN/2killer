<!DOCTYPE html>
<html lang="en">
<head>
  <meta http-equiv="Content-Type" content="text/html; charset=UTF-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta charset="UTF-8" />
  <meta name="description" content="Jeu du killer: Effectuer l'attribution des kills"/>
  <meta name="googlebot" content="Jeu de role, le killer, jeu du killer, role game play, jeu killer, jeu entre amis, killer"/>
  <meta name="robots" content="Jeu de role, le killer, jeu du killer, role game play, jeu killer, jeu entre amis, killer"/>
  <title>The Killer - Jeu de rôle</title>

  <!-- CSS  -->
  <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">
  <link href="/css/materialize.css" type="text/css" rel="stylesheet" media="screen,projection"/>
  <link href="/css/style.css" type="text/css" rel="stylesheet" media="screen,projection"/>

  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-167446947-2"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-167446947-2');
  </script>

</head>
<body class="grey-text  text-lighten-3">
  <nav class="blue-grey darken-4" role="navigation">
    <div class="nav-wrapper container">
      <a id="logo-container" class="brand-logo">The Killer</a>
      <ul class="right hide-on-med-and-down">
        <li><a onClick="window.contact()">Contact</a></li>
      </ul>

      <ul id="nav-mobile" class="sidenav">
        <li><a href="/">Home</a></li>
        <li><a onClick="window.contact()" href="#">Contact</a></li>
      </ul>
      <a href="#" data-target="nav-mobile" class="sidenav-trigger"><i class="material-icons">menu</i></a>
    </div>
  </nav>

  @if(!game)
    <div id="index-banner" class="parallax-container">
      <div class="section no-pad-bot">
        <div class="container">
          <h1 class="header center blue-grey-text text-lighten-2">Jeu du Killer</h1>
          <div class="row center">
            <h5 class="header col s12 light">Jouer au killer sans maitre du jeu</h5>
            <form autocomplete="off" class="form" action="{{ route('game.new') }}" method="POST">
              {{ csrfField() }}
              <button id="download-button" type="submit" class="btn-large waves-effect waves-light blue-grey darken-3">Commencer</button>
            </form>
          </div>
        </div>
      </div>
      <div class="parallax"><img src="/images/assassin_{{backgroundImg}}.jpg" alt="Killer"></div>
    </div>
  @endif

  @if(!game)
    <div class="container">
      <div class="section">

        <!--   Icon Section   -->
        <div class="row">
          <div class="col s12 m4">
            <div class="icon-block">
              <h2 class="center brown-text"><i class="material-icons">psychology</i></h2>
              <h5 class="center">Jeu du Killer</h5>

              <p class="light">Au début de la partie chaque joueur renseigne un kill. Un bon kill est une action amusante, parfois contraignante, mais réalisable. Soyez créatif!
          Lorsque tous les joueurs sont prêts, chacun se voit attribuer un kill et une victime.</p>
            </div>
          </div>

          <div class="col s12 m4">
            <div class="icon-block">
              <h2 class="center brown-text"><i class="material-icons">whatshot</i></h2>
              <h5 class="center">Règles</h5>

              <p class="light">Pour effectuer son kill, un killer doit convaincre sa victime de réaliser l'action qui lui aura été attribuée.
          Lorsqu'un killer effectue son kill, il récupère le kill et la victime de la personne qu'il vient de killer.</p>
            </div>
          </div>

          <div class="col s12 m4">
            <div class="icon-block">
              <h2 class="center brown-text"><i class="material-icons">sports_esports</i></h2>
              <h5 class="center">Maitre du jeu</h5>

              <p class="light">A l'origine, pour jouer au killer, un maitre du jeu était nécéssaire. L'attribution des kills ne pouvait pas s'effectuer de manière totalement aléatoire... Maintenant, c'est possible.</p>
            </div>
          </div>
        </div>

      </div>

    </div>
    @endif


  <div class="parallax-container valign-wrapper">
    <div class="section no-pad-bot">
      <div class="container">
        <div class="row center">
          <h5 class="header col s12 light">Le but du jeu est simplement d'être le dernier survivant.</h5>
        </div>
      </div>
    </div>
    <div class="parallax"><img src="/images/assassin_{{backgroundImg}}.jpg" alt="Killer"></div>
  </div>

  <!--Game Part -->
  @if(game)
    <div class="container">
      <div class="section center">

        @if(isGameOwner && !startedAt)
          <p class="flow-text">Partage avec tes amis pour commencer la partie:</p>
          <div class="row center">
            <div class="col offset-l3 l2 s4">
              <div id="copyTarget" hidden>{{link}}</div>
              <div id="copyButton" class="clipboardButton clipboard"></div>
            </div>
            <div class="col l2 s4">
              @if(isMobile)
                <a class="messenger" href="fb-messenger://share?link={{link}}"><img style="height: 78px;" src="/images/messenger.svg"/></a>
              @endif
              
              @if(!isMobile)
                <a class="messenger" href="http://www.facebook.com/dialog/send?app_id=582407492655263&link={{link}}&redirect_uri={{link}}"><img style="height: 78px;" src="/images/messenger.svg"/></a>
              @endif
            </div>
            <div class="col l2 s4">
              <a class="whatsapp" href="https://api.whatsapp.com/send?text={{link}}" data-action="share/whatsapp/share"><img style="height: 78px;" src="/images/whatsapp.svg"/></a>
            </div>
          </div>
        @endif


        @if(!startedAt && killers && killers.length > 0)
          </br>
          <p class="flow-text">Les killers prêts à en découdre:</p>
          <div class="row">
            <div class="col offset-m3 m6 s12">
              <div class="collection">
                @each(killer in killers)
                  @if(killer == username)
                    <a class="collection-item blue-grey darken-2 white-text">{{killer}}</a>
                  @else
                    <a class="collection-item blue-grey darken-4 white-text">{{killer}}</a>
                  @endif
                @endeach
              </div>
            </div>
          </div>

          <br/>
          <a href="#" onClick="window.location.reload()" class="btn-floating pulse blue-grey darken-4"><i class="material-icons">refresh</i></a>
          <br/><br/>

        @endif

        @if(kill)
          <div class="row">
            <div class="col s12 offset-l3 l6">
              <div class="card blue-grey darken-4">
                <div class="card-content white-text">
                  <span class="card-title">{{victim.username}}</span>
                  <p>{{kill.description}}</p>
                </div>
              </div>
            </div>
          </div>
          @if(!isSuggestKill)
            <div class="row">
              <div class="col s12 m6 offset-m3">
                <div class="card blue-grey lighten-3">
                  <div class="card-content blue-grey-text text-darken-2">
                    <span class="card-title">T'as une nouvelle idée de Kill?</span>
                    <p>Partage la pour qu'on puisse la suggérer aux futurs participants en panne d'inspi.</p>
                  </div>
                  <div class="card-action">
                    <a href="?suggestKill=1" class="blue-grey-text text-darken-1">Go</a>
                  </div>
                </div>
              </div>
            </div>
          @endif
        @endif

        @if(isSuggestKill)
          <form autocomplete="off" class="form" action="{{ route('kill.suggest') }}" method="POST">
            <div class="input-field col offset-m3 m6 s12">
              <input name="description" placeholder="Le kill parfait pour une prochaine partie" value="" required type="text" class="validate">
              <label for="description">Suggestion</label>
            </div>
            {{ csrfField() }}
            <input hidden name="game_id" value="{{ game.id }}"/>
            <button class="btn waves-effect waves-light btn-large blue-grey darken-3" type="submit" name="action">Envoyer
              <i class="material-icons right">send</i>
            </button>  
          </form>
        @endif

        @if(!isKillOwner || (isUpdateKill && !startedAt))
          <form autocomplete="off" class="form" action="{{ route('game') }}" method="POST">

            <div class="row center">
              <form class="col s12">
                <div class="row">
                  <div class="input-field col offset-m3 m6 s12">
                    <input name="username"  placeholder="PiegeAMorue42" id="username" required type="text" value="{{username}}" class="validate">
                    <label for="username">Ton blaze</label>
                  </div>
                </div>
                <div class="row">
                  <div class="input-field col offset-m3 m6 s12">
                    <input name="description" placeholder="{{killSuggestion}}" value="{{ownKill.description || ''}}" required type="text" class="validate">
                    <label for="username">Ton kill</label>
                  </div>
                </div>

                {{ csrfField() }}

                <input hidden name="id" value="{{ game.id }}"/>
                <input hidden name="kill_id" value="{{ ownKill && ownKill.id }}"/>

                @if(isUpdateKill)
                  <button class="btn waves-effect waves-light btn-large blue-grey darken-3" type="submit" name="action">Modifier
                    <i class="material-icons right">send</i>
                  </button>
                @else
                  <button class="btn waves-effect waves-light btn-large blue-grey darken-3" type="submit" name="action">Envoyer
                    <i class="material-icons right">send</i>
                  </button>
                @endif
              </div>

          </form>
        @endif

        @if(!isGameOwner && !startedAt)
          <div class="row">
            <div class="col s12 offset-l3 l6">
              @if(killers.length < minPlayers)
                <div class="card-panel blue-grey lighten-3">
                  <span class="blue-grey-text text-darken-2 ">En attente d'au moins {{minPlayers - killers.length}} autre(s) personne(s)</span>
                </div>
              @else
                @if(game)
                  <div class="card-panel blue-grey lighten-3">
                    <span class="blue-grey-text text-darken-2 ">En attente de lancement par le créateur de la partie...</span>
                  </div>
                @endif
              @endif
            </div>
          </div>
        @endif


        @if(!startedAt && !isUpdateKill && isKillOwner)
          <br/>
          <a href="?updateKill=1" class="blue-grey darken-4 waves-effect waves-light btn btn-small">Modifier mon kill<i class="material-icons right">update</i></a>
        @endif



        @if(isGameOwner && !startedAt)
          <br/><br/>
          <form autocomplete="off" class="form" action="{{ route('game.start', {id: game.id}) }}" method="POST">
            {{ csrfField() }}
            <input hidden name="id" value="{{ game.id }}"/>
            @if(killers.length < 3)
              <div class="card-panel blue-grey lighten-3 col s12 offset-m3 m2">
                <span class="blue-grey-text text-darken-2 ">En attente d'au moins {{minPlayers - killers.length}} autre(s) personne(s)</span>
              </div>
            @else
              @if(!isUpdateKill)
                <button type="submit" class="blue-grey darken-4 waves-effect waves-light btn btn-large">Prêt<i class="material-icons right">play_circle_outline</i></button>
              @endif
            @endif
          </form>
        @endif
      </div>
    </div>

    <!-- Styling Only -->
    <div class="parallax-container valign-wrapper">
    <div class="section no-pad-bot">
      <div class="container">
        <div class="row center">
          <h5 class="header col s12 light">Le but du jeu est simplement d'être le dernier survivant.</h5>
        </div>
      </div>
    </div>
    <div class="parallax"><img src="/images/assassin_{{backgroundImg}}.jpg" alt="Killer"></div>
  </div>

  @endif
  <!-- End Game Part -->


  @if(!game)
    <div class="container">
      <div class="section">

        <div class="row">
          <div class="col s12 center">
            <h3><i class="mdi-content-send brown-text"></i></h3>
            <h4></h4>
            <p class="left-align light">A l'origine, il est nécessaire d'avoir un maitre du jeu se chargeant d'établir un cycle d'attribution des kills. 
          Cela afin d'éviter d'obtenir plusieurs boucles dans le cas d'un tirage au sort totalement aléatoire, comme décrite ci dessus.
          Le rôle du maitre du jeu s'arrète ici.</p>
          <p class="left-align light"> C'est pour pallier à ce problème que nous avons décidé d'implémenter un algorithme de répartition permettant d'obtenir un cycle unique aléatoire.
          L'appli prend le rôle de maitre du jeu et personne n'est laissé de coté.</p>
          <p class="left-align light">La répartition se fait selon les charactéristiques suivantes:</br>
            - Un joueur ne peut pas obtenir son propre kill.</br>
            - Un joueur ne peut pas killer une victime avec le kill de cette dernière.</br></br>
          Attention, c'est le cas uniquement au 1er tour. Après quelques kills vous tomberez forcèment dans ce cas de figure.</p>
          </div>
        </div>

      </div>
    </div>
    @endif


  @if(!game)
    <div id="index-banner" class="parallax-container valign-wrapper">
      <div class="section no-pad-bot">
        <div class="container">
          <h1 class="header center blue-grey-text text-lighten-2">Jeu du Killer</h1>
          <div class="row center">
            <h5 class="header col s12 light">Jouer au killer sans maitre du jeu</h5>
            <form autocomplete="off" class="form" action="{{ route('game.new') }}" method="POST">
              {{ csrfField() }}
              <button id="download-button" type="submit" class="btn-large waves-effect waves-light blue-grey darken-3">Commencer</button>
            </form>
          </div>
        </div>
      </div>
      <div class="parallax"><img src="/images/assassin_{{backgroundImg}}.jpg" alt="Killer"></div>
    </div>
  @endif

  <footer class="page-footer" style="background-color:#32333f!important">
    <div class="container">
      <div class="row center">
        <div class="col s12">
          <p class="white-text underlined text-lighten-4">Released under the MIT License.</p>
          <a href="https://github.com/NkxxkN/2killer" class="white-text text-lighten-4">Github</a>
        </div>
      </div>
    </div>
    <div class="footer-copyright">
      <div class="container center">
        Copyright © 2020-<script>document.write((new Date()).getFullYear())</script> Kevin Antoine
      </div>
    </div>
  </footer>

  <!--  Scripts-->
  <script src="https://code.jquery.com/jquery-2.1.1.min.js"></script>
  <script src="/js/materialize.js"></script>
  <script src="/js/init.js"></script>
  <script src="/js/app.js"></script>
  <script src="/js/drift.js"></script>
  </body>
</html>
